<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact Us - Kimangu Day Secondary School</title>
    <link
      rel="shortcut icon"
      href="/assets/images/logo.png"
      type="image/x-icon"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body class="font-sans text-gray-900 bg-gray-50">
    <div id="nav-placeholder"></div>

    <!-- Hero -->
    <section class="relative py-20 text-center text-white bg-blue-500">
      <div class="absolute inset-0 opacity-10">
        <div
          class="w-full h-full"
          style="
            background-image: url('data:image/svg+xml,%3Csvg width=\'20\' height=\'20\' viewBox=\'0 0 20 20\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cg fill=\'%23ffffff\' fill-opacity=\'1\' fill-rule=\'evenodd\'%3E%3Ccircle cx=\'3\' cy=\'3\' r=\'3\'/%3E%3Ccircle cx=\'13\' cy=\'13\' r=\'3\'/%3E%3C/g%3E%3C/svg%3E');
          "
        ></div>
      </div>
      <div class="max-w-4xl px-4 mx-auto">
        <h1 class="mb-4 text-4xl font-bold md:text-5xl">Contact Us</h1>
        <p class="text-lg md:text-xl">
          We'd love to hear from you. Get in touch for inquiries, visits or
          support.
        </p>
      </div>
    </section>

    <!-- Contact Info & Form -->
    <section class="py-16 bg-white">
      <div class="grid gap-12 px-4 mx-auto max-w-7xl md:grid-cols-2">
        <!-- Contact Details -->
        <div class="p-6 rounded-2xl">
          <h2 class="mb-6 text-2xl font-bold text-gray-800">Get in Touch</h2>
          <ul class="space-y-4 text-gray-700">
            <li>
              <i class="mr-2 text-blue-500 fas fa-map-marker-alt"></i>
              Kimangu, Rongai, Nakuru County
            </li>
            <li>
              <i class="mr-2 text-blue-500 fas fa-phone-alt"></i>
              +254 721 415 851
            </li>
            <li>
              <i class="mr-2 text-blue-500 fa-solid fa-signs-post"></i> P.O. Box
              79, Rongai, Nakuru
            </li>
            <li>
              <i class="mr-2 text-blue-500 fas fa-envelope"></i>
              info@kimangu.sc.ke
            </li>
            <li class="flex items-start">
              <i class="mt-1 mr-2 text-blue-500 fas fa-clock"></i>
              <div>
                <ul class="ml-1 space-y-1">
                  <li>Weekdays: Open 8:00 AM – 5:00 PM</li>
                  <li>Saturday: Open 8:00 AM – 12:00 PM</li>
                  <li>Sunday and Public Holidays: Closed</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>

        <!-- Contact Form -->
        <div>
          <h2 class="mb-6 text-2xl font-bold">Leave Us a Message</h2>
          <form class="space-y-4" id="contactForm">
            <input
              type="text"
              name="fullName"
              placeholder="Full Name"
              class="w-full px-4 py-2 transition-colors border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              required
            />
            <input
              type="email"
              name="email"
              placeholder="Email Address"
              class="w-full px-4 py-2 transition-colors border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              required
            />
            <input
              type="text"
              name="subject"
              placeholder="Subject"
              class="w-full px-4 py-2 transition-colors border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              required
            />
            <textarea
              name="message"
              rows="4"
              placeholder="Your Message"
              class="w-full px-4 py-2 transition-colors border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-vertical"
              required
            ></textarea>
            <button
              type="submit"
              class="px-6 py-3 font-medium text-white transition-all duration-200 bg-blue-500 rounded-lg hover:bg-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
            >
              <i class="mr-2 fas fa-paper-plane"></i>Send Message
            </button>
          </form>
        </div>
      </div>
    </section>

    <!-- Map -->
    <section class="pt-8 pb-16 bg-blue-50">
      <div class="px-4 mx-auto text-center max-w-7xl">
        <h2 class="mb-4 text-2xl font-bold">Visit Us</h2>
        <p class="mb-6">
          We're located 7 km from Rongai town center along Rongai-Kandutura
          Road.
        </p>
        <div class="h-64 overflow-hidden border border-blue-300 rounded-lg">
          <iframe
            width="100%"
            height="100%"
            frameborder="0"
            style="border: 0"
            src="https://maps.google.com/maps?q=-0.150096,35.838525&z=15&output=embed"
            allowfullscreen
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
          >
          </iframe>
        </div>
      </div>
    </section>
    <div id="footer-placeholder"></div>

    <script src="/src/include.js"></script>
    <script>
      // Contact form handler - handles the contact form submission
      document.addEventListener("DOMContentLoaded", function () {
        // Get the contact form element
        const contactForm = document.querySelector("#contactForm");

        // Check if form exists on the page
        if (!contactForm) {
          console.error("Contact form not found");
          return;
        }

        // Add event listener for form submission
        contactForm.addEventListener("submit", async function (event) {
          // Prevent the default form submission
          event.preventDefault();

          // Get the submit button to show loading state
          const submitButton = contactForm.querySelector(
            'button[type="submit"]'
          );
          const originalButtonText = submitButton.innerHTML;

          try {
            // Show loading state
            submitButton.disabled = true;
            submitButton.innerHTML =
              '<i class="mr-2 fas fa-spinner fa-spin"></i>Sending...';
            submitButton.classList.add("opacity-75");

            // Get form data
            const formData = new FormData(contactForm);
            const contactData = {
              fullName: formData.get("fullName").trim(),
              email: formData.get("email").trim(),
              subject: formData.get("subject").trim(),
              message: formData.get("message").trim(),
              submittedAt: new Date().toISOString(),
            };

            // Basic form validation
            if (
              !contactData.fullName ||
              !contactData.email ||
              !contactData.subject ||
              !contactData.message
            ) {
              throw new Error("Please fill in all required fields");
            }

            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(contactData.email)) {
              throw new Error("Please enter a valid email address");
            }

            // Send data to your backend
            const response = await fetch(
              "https://kimangu.vercel.app/contact/form",
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(contactData),
              }
            );

            const result = await response.json();

            if (response.ok) {
              // Show success message
              showNotification(
                "✅ Message sent successfully! We will get back to you soon.",
                "success"
              );

              // Reset the form
              contactForm.reset();
            } else {
              // Show error message
              throw new Error(result.message || "Failed to send message");
            }
          } catch (error) {
            console.error("Error sending message:", error);
            showNotification(
              "❌ " +
                (error.message || "Failed to send message. Please try again."),
              "error"
            );
          } finally {
            // Reset button state
            submitButton.disabled = false;
            submitButton.innerHTML = originalButtonText;
            submitButton.classList.remove("opacity-75");
          }
        });
      });

      // Function to show notifications to the user
      function showNotification(message, type = "info") {
        // Remove any existing notifications
        const existingNotification = document.querySelector(".notification");
        if (existingNotification) {
          existingNotification.remove();
        }

        // Create notification element
        const notification = document.createElement("div");
        notification.className =
          "notification fixed top-4 right-4 z-50 max-w-sm p-4 rounded-lg shadow-lg transition-all duration-300 transform translate-x-0";

        // Set notification style based on type
        if (type === "success") {
          notification.classList.add(
            "bg-green-500",
            "text-white",
            "border-l-4",
            "border-green-700"
          );
        } else if (type === "error") {
          notification.classList.add(
            "bg-red-500",
            "text-white",
            "border-l-4",
            "border-red-700"
          );
        } else {
          notification.classList.add(
            "bg-blue-500",
            "text-white",
            "border-l-4",
            "border-blue-700"
          );
        }

        // Add message and close button
        notification.innerHTML = `
        <div class="flex items-start justify-between">
            <div class="flex-1 mr-3">
                <p class="text-sm font-medium">${message}</p>
            </div>
            <button onclick="this.parentElement.parentElement.remove()" class="text-white hover:text-gray-200 focus:outline-none">
                <i class="fas fa-times"></i>
            </button>
        </div>
    `;

        // Add to page with animation
        document.body.appendChild(notification);

        // Trigger slide-in animation
        setTimeout(() => {
          notification.style.transform = "translateX(0)";
        }, 10);

        // Auto remove after 5 seconds
        setTimeout(() => {
          if (notification.parentNode) {
            notification.style.transform = "translateX(100%)";
            setTimeout(() => {
              if (notification.parentNode) {
                notification.remove();
              }
            }, 300);
          }
        }, 5000);
      }
    </script>
  </body>
</html>
